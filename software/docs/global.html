<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Global</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Global</h1>

    




<section>

<header>
    
        <h2></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


        
    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="PORT"><span class="type-signature">(constant) </span>PORT<span class="type-signature"> :number</span></h4>




<div class="description">
    Porta em que o servidor irá escutar.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line75">line 75</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="__dirname"><span class="type-signature">(constant) </span>__dirname<span class="type-signature"> :string</span></h4>




<div class="description">
    Diretório do arquivo atual (equivalente a __dirname do CommonJS).
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">string</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line92">line 92</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="__filename"><span class="type-signature">(constant) </span>__filename<span class="type-signature"> :string</span></h4>




<div class="description">
    Caminho do arquivo atual (equivalente a __filename do CommonJS).
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">string</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line86">line 86</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="app"><span class="type-signature">(constant) </span>app<span class="type-signature"> :Express</span></h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Express</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line64">line 64</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="cloudCover"><span class="type-signature"></span>cloudCover<span class="type-signature"> :number|null</span></h4>




<div class="description">
    Cobertura de nuvens atual (cloudCover), atualizada via rota /cloudcover.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>
|

<span class="param-type">null</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line104">line 104</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="dadosESP"><span class="type-signature"></span>dadosESP<span class="type-signature"> :Object</span></h4>




<div class="description">
    Último dado meteorológico recebido do ESP.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line98">line 98</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="ultimaAtualizacao"><span class="type-signature"></span>ultimaAtualizacao<span class="type-signature"> :number</span></h4>




<div class="description">
    Timestamp da última atualização recebida do ESP, em milissegundos.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line116">line 116</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="ultimaPrevisao"><span class="type-signature"></span>ultimaPrevisao<span class="type-signature"> :Object|null</span></h4>




<div class="description">
    Última previsão gerada pelo modelo Python.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>
|

<span class="param-type">null</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line110">line 110</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="addInfoPrompt"><span class="type-signature"></span>addInfoPrompt<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Add extra info
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html">src/python/venv/lib/python3.10/site-packages/werkzeug/debug/shared/debugger.js</a>, <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html#line155">line 155</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="addToggleTraceTypesOnClick"><span class="type-signature"></span>addToggleTraceTypesOnClick<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    toggle traceback types on click.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html">src/python/venv/lib/python3.10/site-packages/werkzeug/debug/shared/debugger.js</a>, <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html#line198">line 198</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="esperarCloudCover"><span class="type-signature">(async) </span>esperarCloudCover<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;number>}</span></h4>
    

    



<div class="description">
    Espera até que a variável global `cloudCover` seja definida.Faz verificações a cada 1 segundo até obter um valor válido.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line125">line 125</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Retorna uma Promise que resolve com o valor de "cloudCover" assim que ele for definido.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;number></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="gerarFeatures"><span class="type-signature">(async) </span>gerarFeatures<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;(number|string)>>}</span></h4>
    

    



<div class="description">
    Gera as features necessárias para a previsão e para o salvamento no banco.A função aguarda até que a variável `cloudCover` esteja definida, garantindo quetodos os dados necessários estejam disponíveis. Em seguida, valida se os dadosrecebidos do dispositivo ESP estão presentes e, caso contrário, lança um erro.Retorna um array contendo as principais variáveis meteorológicas que serão usadaspelo modelo de previsão e para o registro no banco de dados.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line144">line 144</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Se `dadosESP` não estiver definido ou estiver vazio.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    Uma Promise que resolve com um array de features,incluindo pressão atmosférica, temperatura, umidade, classificação UV, velocidade e direção do vento,cobertura de nuvens e precipitação.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;(number|string)>></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>try {  const features = await gerarFeatures();  console.log("Features geradas:", features);} catch (error) {  console.error("Erro ao gerar features:", error.message);}</code></pre>



        
            

    

    
    <h4 class="name" id="gerarPrevisao"><span class="type-signature">(async) </span>gerarPrevisao<span class="signature">(features<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Gera a previsão de chuva com base nas *features* meteorológicas,executando um script Python externo responsável pelo modelo de previsão.A função valida o conjunto de *features* fornecido, normaliza os dados eos envia ao script Python (`server.py`) por meio de um processo filho.O resultado retornado pelo Python é lido via *stdout*, interpretado em JSONe resolvido como objeto JavaScript.A previsão resultante é armazenada na variável global `ultimaPrevisao`.Em caso de falha na validação das *features* ou erro na execução/interpretaçãodo script Python, a Promise é rejeitada com uma mensagem descritiva.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>features</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    null
                
                </td>
            

            <td class="description last">Array contendo as *features* meteorológicasnecessárias para a previsão, na seguinte ordem:`[pressaoAtm, temperatura, umidade, uvClassificacao, ventoVelocidade, ventoDirecao, cloudCover, precipitacao]`.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line190">line 190</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Caso as *features* estejam ausentes, inválidas ou ocorra erro ao interpretara resposta do script Python.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    Retorna uma Promise que resolve com o objeto de previsão geradopelo script Python, contendo os resultados do modelo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>try {  const previsao = await gerarPrevisao(features);  console.log("Previsão gerada:", previsao);} catch (error) {  console.error("Erro ao gerar previsão:", error);}</code></pre>



        
            

    

    
    <h4 class="name" id="gerarPrevisaoAgendada"><span class="type-signature">(async) </span>gerarPrevisaoAgendada<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Tarefa agendada para gerar e salvar previsões meteorológicas a cada hora cheia.Esta função é executada automaticamente pelo `node-cron` no minuto zero de cada hora.O fluxo da tarefa é:1. Gera as *features* meteorológicas atuais chamando `gerarFeatures()`.2. Executa o modelo de previsão Python via `gerarPrevisao(features)`.3. Salva as leituras e a previsão no banco de dados com `salvarUltimoDado(features)`.Em caso de erro em qualquer etapa, o erro é registrado no console.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line700">line 700</a>
    </li></ul></dd>
    

    

    

    
</dl>



















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Exemplo de execução automática:// No cron: "0 * * * *" → executa todo dia, na hora cheia.// Console output esperado:Gerando nova previsão programada...Nova previsão gerada: { ... }Previsão e dados salvos com sucesso na hora cheia.// Em caso de erro:Erro ao gerar previsão programada: [Error details]</code></pre>



        
            

    

    
    <h4 class="name" id="iniciarServidor"><span class="type-signature"></span>iniciarServidor<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Inicializa o servidor Express e inicia o agendamento de tarefas.O servidor escuta na porta definida em `PORT` e no endereço "0.0.0.0",permitindo acesso em toda a rede local. Ao iniciar, registra uma mensagemno console confirmando que o servidor está ativo.Também indica que o agendamento de salvamento de previsões a cada horajá foi iniciado pelo cron.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line741">line 741</a>
    </li></ul></dd>
    

    

    

    
</dl>



















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Console output esperado após iniciar o servidor:Servidor rodando na rede na porta 4000Agendamento de salvamento a cada hora cheia iniciado</code></pre>



        
            

    

    
    <h4 class="name" id="openShell"><span class="type-signature"></span>openShell<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Helper function for shell initialization
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html">src/python/venv/lib/python3.10/site-packages/werkzeug/debug/shared/debugger.js</a>, <a href="src_python_venv_lib_python3.10_site-packages_werkzeug_debug_shared_debugger.js.html#line94">line 94</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="salvarUltimoDado"><span class="type-signature">(async) </span>salvarUltimoDado<span class="signature">(features<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    Salva no banco de dados as últimas leituras meteorológicas e a previsão de chuva associada.A função valida o conjunto de *features* recebido, compara com o último registro salvoe insere um novo dado apenas se houver alterações significativas.A probabilidade de chuva é obtida a partir da variável global `ultimaPrevisao`.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>features</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    null
                
                </td>
            

            <td class="description last">Lista de *features* meteorológicas, na seguinte ordem:`[pressaoAtm, temperatura, umidade, uvClassificacao, ventoVelocidade, ventoDirecao, cloudCover, precipitacao]`.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server.js.html">server.js</a>, <a href="server.js.html#line274">line 274</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Se ocorrer falha ao acessar ou gravar no banco de dados.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    Uma Promise que é resolvida após a operação de salvamento (ou ignorada se os dados forem idênticos).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>await salvarUltimoDado([  1013,   // pressaoAtm  26.5,   // temperatura  70,     // umidade  5,      // uvClassificacao  12.3,   // ventoVelocidade  180,    // ventoDirecao  40,     // cloudCover  0       // precipitacao]);</code></pre>



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#PORT">PORT</a></li><li><a href="global.html#__dirname">__dirname</a></li><li><a href="global.html#__filename">__filename</a></li><li><a href="global.html#addInfoPrompt">addInfoPrompt</a></li><li><a href="global.html#addToggleTraceTypesOnClick">addToggleTraceTypesOnClick</a></li><li><a href="global.html#app">app</a></li><li><a href="global.html#cloudCover">cloudCover</a></li><li><a href="global.html#dadosESP">dadosESP</a></li><li><a href="global.html#esperarCloudCover">esperarCloudCover</a></li><li><a href="global.html#gerarFeatures">gerarFeatures</a></li><li><a href="global.html#gerarPrevisao">gerarPrevisao</a></li><li><a href="global.html#gerarPrevisaoAgendada">gerarPrevisaoAgendada</a></li><li><a href="global.html#iniciarServidor">iniciarServidor</a></li><li><a href="global.html#openShell">openShell</a></li><li><a href="global.html#salvarUltimoDado">salvarUltimoDado</a></li><li><a href="global.html#ultimaAtualizacao">ultimaAtualizacao</a></li><li><a href="global.html#ultimaPrevisao">ultimaPrevisao</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Tue Nov 11 2025 19:48:35 GMT-0300 (Horário Padrão de Brasília)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>